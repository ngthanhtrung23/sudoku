{"version":3,"sources":["utils/set.ts","models/cell.ts","models/sandwichCell.ts","models/board.ts","actions/types.ts","actions/history.ts","actions/board.ts","components/board/Cell.tsx","utils/sandwich.ts","components/board/SandwichCell.tsx","components/board/Board.tsx","utils/bits.ts","utils/solver.ts","components/control/DisplayOptions.tsx","actions/control.ts","components/control/GameOptions.tsx","components/control/Control.tsx","components/Palette.tsx","components/Game.tsx","models/control.ts","models/history.ts","reducers/index.ts","reducers/board.ts","reducers/control.ts","reducers/history.ts","reducers/gameUrl.ts","index.tsx"],"names":["set_intersection","a","b","Set","filter","x","has","CellModel","id","value","cornerValues","centerValues","selected","restricted","error","row","col","isFixed","color","this","SandwichCellModel","BoardModel","cells","highlightMatching","multiSelectMode","rowSandwich","colSandwich","i","push","result","forEach","cell","fixed","Array","from","obj","rowSandwiches","map","colSandwiches","JSON","stringify","serialized","clearAllErrors","clearAllRestricteds","clearAllSelections","deserialized","parse","cellId","toRowCol","getRegionByPosition","gameOptions","col2","add","toCellId","row2","region","getRegion","antiKnight","di","dj","isInside","antiKing","delete","myValue","getVisibleCells","neighborId","seenValues","getPossibleValues","undefined","find","values","indexOf","left","Math","min","right","max","sum","slice","rowId","colId","getSandwichSum","getRowValues","getColValues","cellIds","newValue","autoCleanup","setValueOfSingleCell","clear","NO_OP","type","redo","history","boards","length","payload","undo","updateBoard","board","select","control","clearSelection","setMultiSelect","newBoard","_","cloneDeep","setSelected","displayOptions","highlightRestricted","setRestricted","highlightMatchingNumbers","selectedValues","getSelectedValues","size","selectedValue","next","selectSandwich","isRow","sandwich","Error","move","d_row","d_col","r","c","Cell","props","className","sortedValues","sort","classes","shouldHighlightMatching","key","isRegionTop","isRegionLeft","isBoardLeft","isBoardRight","isBoardTop","isBoardBottom","innerClasses","join","onClick","onMouseDown","onTouchStart","onMouseOver","onTouchMove","renderCellMainValue","renderCellCornerValues","renderCellCenterValues","React","Component","sumToSeqs","0","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","35","sandwichLengths","SandwichCell","sandwichHint","seqs","seq","index","tooltip","Tooltip","OverlayTrigger","placement","overlay","defaultValue","renderSandwichHint","connector","connect","state","Board","e","String","onSelectSandwich","startingCell","keys","renderCell","sandwichCell","renderSandwichCell","sandwichCells","renderEmptySandwichCell","sandwichRow","renderSandwichRow","rows","renderRow","bitCount","n","bitContains","bit","toRowId","toColId","equals","compare","CandidateStore","_candidates","candidates","set","candidate","SortedSet","res","hasCandidate","minNode","remove","setCandidate","getValidSandwichValues","len","mustHave","mustNot","inside","insides","outsides","seq_set","can","applySandwichClues","candidateStore","sandwichSum","removeCandidate","indexOf19","possibleLens","abs","attempt","getBestCell","cntCandidates","solution","fromCharCode","firstSolution","cntSolutions","getCandidates","saveValues","clone","saveCandidates","removeCell","neighborIds","cnt","solveBoard","fillAllPossibleValues","mask","isValid","attemptSandwich","bestCount","bestId","oneOrNine","cnt1","cnt9","DisplayOptions","Form","Check","label","checked","onChange","updateDisplay","autoCleanUp","renderSandwichDisplayOptions","GameOptions","message","renderLabel","updateGameOptions","Control","url","href","Button","verify","renderTooltip","fillCenter","solve","generateUrl","renderUrl","gameUrl","gameState","rowSandwichSums","colSandwichSums","window","location","origin","pathname","btoa","alert","invalidCellIds","getInvalidCellIds","setErrors","hasError","want","getRowSandwichSum","getColSandwichSum","Palette","colors","renderColor","clearAllColors","colorSelectedCells","Game","encoded","initGameState","atob","onKeyDown","keyDown","tabIndex","onMouseUp","mouseUp","onTouchEnd","metaKey","mouseDown","mouseOver","ownProps","match","params","decodedState","isShift","shiftKey","isMeta","keyCode","KeyCode","hasSelected","toggleCornerValuesOfSelectedCells","toggleCornerValues","preventDefault","toggleCenterValuesOfSelectedCells","toggleCenterValues","setValueOfSelectedCells","setValue","hasSandwichSelected","setSandwichValue","unsetSelectedCells","unsetValue","clearCornerValuesOfSelectedCells","clearCenterValuesOfSelectedCells","pressBackspace","pressEsc","Object","assign","ControlModel","HistoryModel","serialize","combineReducers","action","load","assert","isMouseDown","store","createStore","reducers","__REDUX_DEVTOOLS_EXTENSION__","ReactDOM","render","path","component","document","getElementById"],"mappings":"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,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,EAAG,IAEjBC,GAAI,CACA,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,EAAG,GACb,CAAC,EAAG,EAAG,EAAG,EAAG,IAEjBC,GAAI,CACA,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,EAAG,GACb,CAAC,EAAG,EAAG,EAAG,EAAG,IAEjBC,GAAI,CACA,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,EAAG,GACb,CAAC,EAAG,EAAG,EAAG,EAAG,GACb,CAAC,EAAG,EAAG,EAAG,EAAG,IAEjBC,GAAI,CACA,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,EAAG,GACb,CAAC,EAAG,EAAG,EAAG,EAAG,GACb,CAAC,EAAG,EAAG,EAAG,EAAG,IAEjBC,GAAI,CACA,CAAC,EAAG,EAAG,EAAG,GACV,CAAC,EAAG,EAAG,EAAG,EAAG,GACb,CAAC,EAAG,EAAG,EAAG,EAAG,GACb,CAAC,EAAG,EAAG,EAAG,EAAG,IAEjBC,GAAI,CACA,CAAC,EAAG,EAAG,EAAG,EAAG,GACb,CAAC,EAAG,EAAG,EAAG,EAAG,GACb,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,IAEpBC,GAAI,CACA,CAAC,EAAG,EAAG,EAAG,EAAG,GACb,CAAC,EAAG,EAAG,EAAG,EAAG,GACb,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,IAEpBC,GAAI,CACA,CAAC,EAAG,EAAG,EAAG,EAAG,GACb,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,IAEpBC,GAAI,CACA,CAAC,EAAG,EAAG,EAAG,EAAG,GACb,CAAC,EAAG,EAAG,EAAG,E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","file":"static/js/main.e6af6bcc.chunk.js","sourcesContent":["export const set_intersection = (a: Set<any>, b: Set<any>): Set<any> => {\n    return new Set([...a].filter(x => b.has(x)));\n}\n\nexport const set_difference = (a: Set<any>, b: Set<any>): Set<any> => {\n    return new Set([...a].filter(x => !b.has(x)));\n}\n","export type CellValue = '1' | '2' | '3' | '4' | '5' | '6' | '7' | '8' | '9' | null;\n\nexport class CellModel {\n    value: CellValue;\n    cornerValues: Set<CellValue>;\n    centerValues: Set<CellValue>;\n    selected: boolean;\n    restricted: boolean;\n    error: boolean;\n    row: number;\n    col: number;\n    id: number;\n    isFixed: boolean | null;\n    color: number | null;\n\n    constructor(id: number) {\n        this.value = null;\n        this.cornerValues = new Set();\n        this.centerValues = new Set();\n        this.selected = false;\n        this.restricted = false;\n        this.error = false;\n        this.isFixed = false;\n        this.color = null;\n\n        this.row = ~~(id / 9);\n        this.col = id % 9;\n        this.id = id;\n    }\n\n    isRegionTop(): boolean {\n        return this.row % 3 === 0;\n    }\n    isRegionBottom(): boolean {\n        return this.row % 3 === 2;\n    }\n    isRegionLeft(): boolean {\n        return this.col % 3 === 0;\n    }\n    isRegionRight(): boolean {\n        return this.col % 3 === 2;\n    }\n\n    isBoardTop(): boolean {\n        return this.row === 0;\n    }\n    isBoardBottom(): boolean {\n        return this.row === 8;\n    }\n    isBoardLeft(): boolean {\n        return this.col === 0;\n    }\n    isBoardRight(): boolean {\n        return this.col === 8;\n    }\n}\n","export class SandwichCellModel {\n    value: number | null;\n    selected: boolean;\n    error: boolean;\n    isFixed: boolean;\n    id: string;\n    color: number | null;\n\n    constructor(id: string) {\n        this.id = id;\n        this.value = null;\n        this.selected = false;\n        this.error = false;\n        this.isFixed = false;\n        this.color = null;\n    }\n\n    isValid(): boolean {\n        return this.value === null\n            || this.value === 0\n            || this.value === 35\n            || (2 <= this.value && this.value <= 33);\n    }\n};\n","import { set_difference, set_intersection } from '../utils/set';\nimport { CellModel, CellValue } from './cell';\nimport { GameOptions } from './control';\nimport { SandwichCellModel } from './sandwichCell';\n\n// Serialized types used for storing history.\ntype SerializedCell = {\n    value: CellValue;\n    fixed: boolean | null;\n    color: number | null;\n    cornerValues: Array<CellValue>;\n    centerValues: Array<CellValue>;\n};\ntype SerializedSandwich = {\n    value: number | null;\n    fixed: boolean;\n    color: number | null;\n};\ntype Serialized = {\n    cells: Array<SerializedCell>;\n    rowSandwiches: Array<SerializedSandwich>;\n    colSandwiches: Array<SerializedSandwich>;\n};\n\nclass BoardModel {\n    cells: Array<CellModel>;\n    highlightMatching: CellValue;\n    multiSelectMode: boolean;\n\n    // For sandwich sudoku\n    // For each row and column, we may be given the sum of cells between the cells containing 1 and 9.\n    rowSandwich: Array<SandwichCellModel>;\n    colSandwich: Array<SandwichCellModel>;\n\n    constructor() {\n        this.cells = [];\n        for (let i = 0; i < 81; i++) {\n            this.cells.push(new CellModel(i));\n        }\n        this.highlightMatching = null;\n        this.multiSelectMode = false;\n\n        this.rowSandwich = [];\n        this.colSandwich = [];\n        for (let i = 0; i < 9; i++) {\n            this.rowSandwich.push(new SandwichCellModel(`row-${i}`));\n            this.colSandwich.push(new SandwichCellModel(`col-${i}`));\n        }\n    }\n\n    // Used for maintaining board history.\n    serialize(): string {\n        let result: Array<SerializedCell> = [];\n\n        this.cells.forEach((cell) => {\n            result.push({\n                value: cell.value,\n                fixed: cell.isFixed,\n                color: cell.color,\n                cornerValues: Array.from(cell.cornerValues),\n                centerValues: Array.from(cell.centerValues),\n            });\n        });\n        let obj: Serialized = {\n            cells: result,\n            rowSandwiches: this.rowSandwich.map(cell => { return { value: cell.value, fixed: cell.isFixed, color: cell.color }; }),\n            colSandwiches: this.colSandwich.map(cell => { return { value: cell.value, fixed: cell.isFixed, color: cell.color }; }),\n        };\n        return JSON.stringify(obj);\n    }\n\n    // Used for maintaining board history.\n    load(serialized: string): void {\n        this.clearAllErrors();\n        this.clearAllRestricteds();\n        this.clearAllSelections();\n\n        const deserialized = JSON.parse(serialized) as Serialized;\n        const cells = deserialized.cells;\n        for (let i = 0; i < 81; i++) {\n            this.cells[i].value = cells[i].value;\n            this.cells[i].isFixed = cells[i].fixed;\n            this.cells[i].color = cells[i].color;\n            this.cells[i].cornerValues = new Set(cells[i].cornerValues);\n            this.cells[i].centerValues = new Set(cells[i].centerValues);\n        }\n\n        for (let i = 0; i < 9; i++) {\n            this.rowSandwich[i].value = deserialized.rowSandwiches[i].value;\n            this.rowSandwich[i].isFixed = deserialized.rowSandwiches[i].fixed;\n            this.rowSandwich[i].color = deserialized.rowSandwiches[i].color;\n\n            this.colSandwich[i].value = deserialized.colSandwiches[i].value;\n            this.colSandwich[i].isFixed = deserialized.colSandwiches[i].fixed;\n            this.colSandwich[i].color = deserialized.colSandwiches[i].color;\n        }\n    }\n\n    /** Check if a (row, col) is within the board. */\n    isInside(row: number, col: number): boolean {\n        return 0 <= row && row < 9 && 0 <= col && col < 9;\n    }\n\n    toCellId(row: number, col: number): number {\n        return row * 9 + col;\n    }\n\n    toRowCol(cellId: number): [number, number] {\n        return [~~(cellId / 9), cellId % 9];\n    }\n\n    getRegionByPosition(row: number, col: number): number {\n        const r = ~~(row / 3);\n        const c = ~~(col / 3);\n        return r * 3 + c;\n    }\n\n    getRegion(cellId: number): number {\n        const [row, col] = this.toRowCol(cellId);\n        return this.getRegionByPosition(row, col);\n    }\n\n    /**\n     * Return set of cells visible from a single cell, not including\n     * that cell.\n     */\n    getVisibleCells(cellId: number, gameOptions: GameOptions): Set<number> {\n        const [row, col] = this.toRowCol(cellId);\n\n        let result: Set<number> = new Set();\n\n        // Same row\n        for (let col2 = 0; col2 < 9; col2++) {\n            result.add(this.toCellId(row, col2));\n        }\n        // Same colum\n        for (let row2 = 0; row2 < 9; row2++) {\n            result.add(this.toCellId(row2, col));\n        }\n        // Same region\n        const region = this.getRegion(cellId);\n        for (let i = 0; i < 81; i++) {\n            if (this.getRegion(i) === region) {\n                result.add(i);\n            }\n        }\n\n        // Anti-knight\n        if (gameOptions.antiKnight) {\n            for (let di = -2; di <= 2; di++) {\n                for (let dj = -2; dj <= 2; dj++) {\n                    if (di*di + dj*dj === 5) {\n                        const row2 = row + di;\n                        const col2 = col + dj;\n                        if (this.isInside(row2, col2)) {\n                            result.add(this.toCellId(row2, col2));\n                        }\n                    }\n                }\n            }\n        }\n\n        // Anti-king\n        if (gameOptions.antiKing) {\n            for (let di = -1; di <= 1; di++) {\n                for (let dj = -1; dj <= 1; dj++) {\n                    const row2 = row + di;\n                    const col2 = col + dj;\n                    if (this.isInside(row2, col2)) {\n                        result.add(this.toCellId(row2, col2));\n                    }\n                }\n            }\n        }\n\n        // Do not include the same cell.\n        result.delete(cellId);\n        return result;\n    }\n\n    getInvalidCellIds(gameOptions: GameOptions): Set<number> {\n        let result: Set<number> = new Set();\n        for (let i = 0; i < 81; i++) {\n            const myValue = this.cells[i].value;\n            if (myValue) {\n                this.getVisibleCells(i, gameOptions).forEach(neighborId => {\n                    if (myValue === this.cells[neighborId].value) {\n                        result.add(i);\n                        result.add(neighborId);\n                    }\n                })\n            }\n        }\n        return result;\n    }\n\n    getPossibleValues(cellId: number, gameOptions: GameOptions): Set<CellValue> {\n        const seenValues = Array.from(this.getVisibleCells(cellId, gameOptions))\n            .map(neighborId => this.cells[neighborId].value)\n            .filter(x => x);\n\n        return set_difference(new Set(['1', '2', '3', '4', '5', '6', '7', '8', '9']), new Set(seenValues));\n    }\n\n    fillAllPossibleValues(gameOptions: GameOptions): void {\n        this.cells.forEach(cell => {\n            if (!cell.value) {\n                cell.centerValues = this.getPossibleValues(cell.id, gameOptions);\n            }\n        });\n    }\n\n    hasSelected(): boolean {\n        return this.cells.find(cell => cell.selected) !== undefined;\n    }\n\n    hasSandwichSelected(): boolean {\n        return this.rowSandwich.find(cell => cell.selected) !== undefined\n            || this.colSandwich.find(cell => cell.selected) !== undefined;\n    }\n\n    getSandwichSum(values: Array<CellValue>): number | null {\n        if (values.indexOf('1') < 0 || values.indexOf('9') < 0) {\n            return null;\n        }\n        const left = Math.min(values.indexOf('1'), values.indexOf('9'));\n        const right = Math.max(values.indexOf('1'), values.indexOf('9'));\n\n        let sum = 0;\n        for (let value of values.slice(left + 1, right)) {\n            if (value === null) {\n                return null;\n            }\n            sum += +value;\n        }\n        return sum;\n    }\n\n    getRowValues(rowId: number): Array<CellValue> {\n        return this.cells.slice(rowId * 9, rowId * 9 + 9).map(cell => cell.value);\n    }\n\n    getColValues(colId: number): Array<CellValue> {\n        return this.cells.filter(cell => cell.id % 9 === colId).map(cell => cell.value);\n    }\n\n    getRowSandwichSum(rowId: number): number | null {\n        return this.getSandwichSum(this.getRowValues(rowId));\n    }\n\n    getColSandwichSum(colId: number): number | null {\n        return this.getSandwichSum(this.getColValues(colId));\n    }\n\n    setSelected(cellId: number): void {\n        this.cells[cellId].selected = true;\n    }\n\n    getSelectedValues(): Set<CellValue> {\n        return new Set(\n            this.cells\n                .filter((cell) => cell.selected)\n                .filter((cell) => cell.value)\n                .map((cell) => cell.value)\n        );\n    }\n\n    setRestricted(gameOptions: GameOptions): void {\n        let restricted: Set<any> | null = null;\n\n        for (let id = 0; id < 81; id++) {\n            if (this.cells[id].selected) {\n                if (restricted === null) {\n                    restricted = this.getVisibleCells(id, gameOptions);\n                } else {\n                    restricted = set_intersection(this.getVisibleCells(id, gameOptions), restricted);\n                }\n            }\n        }\n\n        if (restricted) {\n            restricted.forEach((cellId) => {\n                this.cells[cellId].restricted = true;\n            });\n        }\n    }\n\n    setErrors(cellIds: Set<number>): void {\n        cellIds.forEach((id) => {\n            this.cells[id].error = true;\n        });\n    }\n\n    setValueOfSingleCell(cellId: number, newValue: CellValue, gameOptions: GameOptions, autoCleanup: boolean): void {\n        if (this.cells[cellId].isFixed) {\n            return;\n        }\n        this.cells[cellId].value = newValue;\n        if (autoCleanup) {\n            this.getVisibleCells(this.cells[cellId].id, gameOptions).forEach((id) => {\n                this.cells[id].cornerValues.delete(newValue);\n                this.cells[id].centerValues.delete(newValue);\n            });\n        }\n    }\n\n    setValueOfSelectedCells(newValue: CellValue, gameOptions: GameOptions, autoCleanup: boolean = false): void {\n        this.cells\n            .filter(cell => cell.selected)\n            .forEach(cell => this.setValueOfSingleCell(cell.id, newValue, gameOptions, autoCleanup));\n    }\n\n    colorSelectedCells(color: number | null): void {\n        this.cells\n            .filter(cell => cell.selected)\n            .forEach(cell => cell.color = color);\n        \n        // Also allow color sandwich clues.\n        this.rowSandwich\n            .filter(cell => cell.selected)\n            .forEach(cell => cell.color = color);\n        this.colSandwich\n            .filter(cell => cell.selected)\n            .forEach(cell => cell.color = color);\n    }\n\n    clearAllColors(): void {\n        this.cells.forEach(cell => cell.color = null);\n        this.rowSandwich.forEach(cell => cell.color = null);\n        this.colSandwich.forEach(cell => cell.color = null);\n    }\n\n    unsetSelectedCells(): void {\n        this.cells\n            .filter(cell => cell.selected && !cell.isFixed)\n            .forEach(cell => { cell.value = null });\n        \n        [...this.rowSandwich, ...this.colSandwich]\n            .filter(cell => cell.selected && !cell.isFixed)\n            .forEach(cell => { cell.value = null });\n    }\n\n    toggleCornerValuesOfSelectedCells(value: CellValue): void {\n        this.cells.forEach((cell) => {\n            if (cell.selected) {\n                if (cell.cornerValues.has(value)) {\n                    cell.cornerValues.delete(value);\n                } else {\n                    cell.cornerValues.add(value);\n                }\n            }\n        });\n    }\n\n    clearCornerValuesOfSelectedCells(): void {\n        this.cells.forEach((cell) => {\n            if (cell.selected) {\n                cell.cornerValues.clear();\n            }\n        })\n    }\n\n    toggleCenterValuesOfSelectedCells(value: CellValue): void {\n        this.cells.forEach((cell) => {\n            if (cell.selected) {\n                if (cell.centerValues.has(value)) {\n                    cell.centerValues.delete(value);\n                } else {\n                    cell.centerValues.add(value);\n                }\n            }\n        });\n    }\n\n    clearCenterValuesOfSelectedCells(): void {\n        this.cells.forEach((cell) => {\n            if (cell.selected) {\n                cell.centerValues.clear();\n            }\n        });\n    }\n\n    clearAllSelections(): void {\n        this.cells.forEach((cell) => {\n            cell.selected = false;\n        });\n        this.rowSandwich.forEach((cell) => {\n            cell.selected = false;\n        });\n        this.colSandwich.forEach((cell) => {\n            cell.selected = false;\n        });\n    }\n\n    clearAllRestricteds(): void {\n        this.cells.forEach((cell) => {\n            cell.restricted = false;\n        });\n    }\n\n    clearAllErrors(): void {\n        this.cells.forEach(cell => { cell.error = false });\n        this.rowSandwich.forEach(cell => { cell.error = false });\n        this.colSandwich.forEach(cell => { cell.error = false });\n    }\n}\n\nexport { BoardModel };\n","import { BoardModel } from '../models/board';\nimport { DisplayOptions, GameOptions } from '../models/control';\n\nexport const ACTION_NO_OP = 'ACTION_NO_OP';\nexport interface NoOpAction {\n    type: typeof ACTION_NO_OP,\n};\nexport const NO_OP: NoOpAction = { type: ACTION_NO_OP };\n\n// Board actions.\nexport const ACTION_UPDATE_BOARD = 'ACTION_UPDATE_BOARD';\nexport const ACTION_GENERATE_URL = 'ACTION_GENERATE_URL';\nexport const ACTION_INIT_GAME_STATE = 'ACTION_INIT_GAME_STATE';\n\nexport interface UpdateBoardAction {\n    type: typeof ACTION_UPDATE_BOARD,\n    payload: {\n        board: BoardModel,\n    },\n};\nexport interface GenerateUrlAction {\n    type: typeof ACTION_GENERATE_URL,\n    payload: {\n        url: string,\n    },\n};\nexport interface InitGameStateAction {\n    type: typeof ACTION_INIT_GAME_STATE,\n    payload: {\n        board: BoardModel,\n        gameOptions: GameOptions,\n    }\n};\n\n// Control actions.\nexport const ACTION_UPDATE_DISPLAY = 'ACTION_UPDATE_DISPLAY';\nexport const ACTION_UPDATE_GAME_PLAY = 'ACTION_UPDATE_GAME_PLAY';\n\ninterface UpdateDisplayAction {\n    type: typeof ACTION_UPDATE_DISPLAY,\n    payload: DisplayOptions,\n};\n\ninterface UpdateGameOptionsAction {\n    type: typeof ACTION_UPDATE_GAME_PLAY,\n    payload: GameOptions,\n}\n\n// History actions.\nexport const ACTION_REDO = 'ACTION_REDO';\nexport const ACTION_UNDO = 'ACTION_UNDO';\n\nexport interface RedoAction {\n    type: typeof ACTION_REDO,\n    payload: {\n        serialized: string,\n    },\n};\nexport interface UndoAction {\n    type: typeof ACTION_UNDO,\n    payload: {\n        serialized: string,\n    },\n};\n\n// Combine all action types.\nexport type ActionTypes = NoOpAction\n    | UpdateBoardAction | GenerateUrlAction | InitGameStateAction\n    | UpdateDisplayAction | UpdateGameOptionsAction\n    | RedoAction | UndoAction;\n","import { HistoryModel } from '../models/history';\nimport {\n    ACTION_REDO,\n    ACTION_UNDO,\n    ActionTypes,\n    NO_OP\n    } from './types';\n\n\nexport const redo = (history: HistoryModel): ActionTypes => {\n    if (history.id >= history.boards.length - 1) {\n        // Nothing to redo.\n        return NO_OP;\n    }\n    return {\n        type: ACTION_REDO,\n        payload: {\n            serialized: history.boards[history.id + 1],\n        },\n    };\n};\n\nexport const undo = (history: HistoryModel): ActionTypes => {\n    if (history.id === 0) {\n        // Nothing to do.\n        return NO_OP;\n    }\n    return {\n        type: ACTION_UNDO,\n        payload: {\n            serialized: history.boards[history.id - 1],\n        },\n    };\n};\n","import * as KeyCode from 'keycode-js';\nimport _ from 'lodash';\nimport { BoardModel } from '../models/board';\nimport { CellValue } from '../models/cell';\nimport { ControlModel } from '../models/control';\nimport { HistoryModel } from '../models/history';\nimport { redo, undo } from './history';\nimport {\n    ACTION_INIT_GAME_STATE,\n    ACTION_UPDATE_BOARD,\n    ActionTypes,\n    NO_OP\n    } from './types';\n\n\nexport const initGameState = (decodedState: any): ActionTypes => {\n    const board = new BoardModel();\n    for (let i = 0; i < 81; i++) {\n        const value = decodedState.values[i];\n        if (value !== '0') {\n            board.cells[i].value = decodedState.values[i] as CellValue;\n            board.cells[i].isFixed = true;\n        }\n    }\n    if (decodedState.rowSandwichSums) {\n        for (let i = 0; i < 9; i++) {\n            board.rowSandwich[i].value = decodedState.rowSandwichSums[i];\n            board.rowSandwich[i].isFixed = true;\n        }\n    }\n    if (decodedState.colSandwichSums) {\n        for (let i = 0; i < 9; i++) {\n            board.colSandwich[i].value = decodedState.colSandwichSums[i];\n            board.colSandwich[i].isFixed = true;\n        }\n    }\n    return {\n        type: ACTION_INIT_GAME_STATE,\n        payload: {\n            board: board,\n            gameOptions: decodedState.gameOptions,\n        },\n    }\n};\n\nexport const updateBoard = (board: BoardModel): ActionTypes => {\n    return {\n        type: ACTION_UPDATE_BOARD,\n        payload: {\n            board: board,\n        }\n    };\n};\n\nconst pressEsc = (board: BoardModel): ActionTypes => {\n    let newBoard = _.cloneDeep(board);\n    newBoard.clearAllSelections();\n    newBoard.clearAllRestricteds();\n    newBoard.highlightMatching = null;\n    return updateBoard(newBoard);\n}\n\nexport const select = (\n        board: BoardModel,\n        control: ControlModel,\n        cellId: number,\n        clearSelection: boolean = true,\n        setMultiSelect: boolean | null = null\n        ): ActionTypes => {\n    let newBoard = _.cloneDeep(board);\n\n    if (setMultiSelect !== null) {\n        newBoard.multiSelectMode = setMultiSelect;\n    }\n\n    if (clearSelection) {\n        newBoard.clearAllSelections();\n        newBoard.clearAllRestricteds();\n        newBoard.highlightMatching = null;\n    } else {\n        newBoard.clearAllRestricteds();\n    }\n\n    newBoard.setSelected(cellId);\n\n    if (control.displayOptions.highlightRestricted) {\n        newBoard.setRestricted(control.gameOptions);\n    }\n    if (control.displayOptions.highlightMatchingNumbers) {\n        newBoard.highlightMatching = null;\n\n        const selectedValues = newBoard.getSelectedValues();\n        if (selectedValues.size === 1) {\n            const selectedValue = selectedValues.values().next().value;\n            newBoard.highlightMatching = selectedValue;\n        }\n    }\n\n    return updateBoard(newBoard);\n}\n\nexport const selectSandwich = (\n        board: BoardModel,\n        control: ControlModel,\n        isRow: boolean,\n        id: number): ActionTypes => {\n    let newBoard = _.cloneDeep(board);\n    if (!control.gameOptions.sandwich) {\n        throw new Error('Attempt to select sandwich in normal mode');\n    }\n\n    newBoard.clearAllSelections();\n    newBoard.clearAllRestricteds();\n    newBoard.highlightMatching = null;\n\n    if (isRow) {\n        newBoard.rowSandwich[id].selected = true;\n    } else {\n        newBoard.colSandwich[id].selected = true;\n    }\n\n    return updateBoard(newBoard);\n}\n\nexport const mouseDown = (board: BoardModel, control: ControlModel, cellId: number, clearSelection: boolean): ActionTypes => {\n    return select(board, control, cellId, clearSelection, true);\n}\n\nexport const mouseOver = (board: BoardModel, control: ControlModel, cellId: number): ActionTypes => {\n    if (!board.multiSelectMode) {\n        return NO_OP;\n    }\n    return select(board, control, cellId, false);\n}\n\nexport const mouseUp = (board: BoardModel): ActionTypes => {\n    return updateBoard(Object.assign(board, { multiSelectMode: false}));\n}\n\nconst setValue = (board: BoardModel, control: ControlModel, newValue: CellValue): ActionTypes => {\n    let newBoard = _.cloneDeep(board);\n\n    newBoard.clearAllErrors();\n    newBoard.setValueOfSelectedCells(\n        newValue,\n        control.gameOptions,\n        control.displayOptions.autoCleanUp);\n\n    if (control.displayOptions.highlightMatchingNumbers) {\n        newBoard.highlightMatching = null;\n\n        const selectedValues = newBoard.getSelectedValues();\n        if (selectedValues.size === 1) {\n            const selectedValue = selectedValues.values().next().value;\n            newBoard.highlightMatching = selectedValue;\n        }\n    }\n    return updateBoard(newBoard);\n};\n\nconst setSandwichValue = (board: BoardModel, newValue: number): ActionTypes => {\n    let newBoard = _.cloneDeep(board);\n\n    newBoard.clearAllErrors();\n    [...newBoard.rowSandwich, ...newBoard.colSandwich]\n        .filter(cell => cell.selected && !cell.isFixed)\n        .forEach(cell => {\n            if (cell.value === null) cell.value = newValue;\n            else if (cell.value < 10) cell.value = cell.value * 10 + newValue;\n        });\n    return updateBoard(newBoard);\n};\n\nconst unsetValue = (board: BoardModel): ActionTypes => {\n    let newBoard = _.cloneDeep(board);\n\n    newBoard.clearAllErrors();\n    newBoard.unsetSelectedCells();\n\n    return updateBoard(newBoard);\n};\n\nconst toggleCornerValues = (board: BoardModel, newValue: CellValue): ActionTypes => {\n    let newBoard = _.cloneDeep(board);\n    newBoard.toggleCornerValuesOfSelectedCells(newValue);\n\n    return updateBoard(newBoard);\n}\n\nconst toggleCenterValues = (board: BoardModel, newValue: CellValue): ActionTypes => {\n    let newBoard = _.cloneDeep(board);\n    newBoard.toggleCenterValuesOfSelectedCells(newValue);\n    return updateBoard(newBoard);\n}\n\n// Move selected cell in direction (d_row, d_col).\n// If there are more than one selected cells, only move the first one.\nconst move = (board: BoardModel, control: ControlModel, d_row: number, d_col: number): ActionTypes => {\n    let r = 0, c = 0;  // by default, assume that we selected (0, 0).\n    for (let i = 0; i < 81; i++) {\n        if (board.cells[i].selected) {\n            [r, c] = board.toRowCol(i);\n            break;\n        }\n    }\n    for (let i = 0; i < 9; i++) {\n        if (board.colSandwich[i].selected) {\n            r = -1;\n            c = i;\n            break;\n        }\n        if (board.rowSandwich[i].selected) {\n            r = i;\n            c = -1;\n        }\n    }\n\n    if (control.gameOptions.sandwich) {\n        r = (r + d_row + 10) % 10;\n        c = (c + d_col + 10) % 10;\n\n        if (r === 9 && c === 9) {\n            // This is the empty cell outside board.\n            return selectSandwich(board, control, false, 0);\n        } else if (r === 9) {\n            // Column sandwich\n            return selectSandwich(board, control, false, c);\n        } else if (c === 9) {\n            // Row sandwich\n            return selectSandwich(board, control, true, r);\n        } else {\n            return select(board, control, board.toCellId(r, c));\n        }\n    } else {\n        r = (r + d_row + 9) % 9;\n        c = (c + d_col + 9) % 9;\n        return select(board, control, board.toCellId(r, c));\n    }\n}\n\nconst pressBackspace = (board: BoardModel): ActionTypes => {\n    let newBoard = _.cloneDeep(board);\n\n    newBoard.clearAllErrors();\n    newBoard.unsetSelectedCells();\n\n    newBoard.clearCornerValuesOfSelectedCells();\n    newBoard.clearCenterValuesOfSelectedCells();\n\n    return updateBoard(newBoard);\n}\n\nexport const keyDown = (board: BoardModel, control: ControlModel, history: HistoryModel, e: any): ActionTypes => {\n    let isShift = !!e.shiftKey;\n    let isMeta = !!e.metaKey;\n\n    // Pressed 0-9\n    if (e.keyCode >= KeyCode.KEY_0 && e.keyCode <= KeyCode.KEY_9) {\n        if (e.keyCode !== KeyCode.KEY_0 && board.hasSelected()) {\n            const value = String.fromCharCode(e.keyCode) as CellValue;\n            if (isShift) {\n                return toggleCornerValues(board, value)\n            } else if (isMeta) {\n                e.preventDefault();\n                return toggleCenterValues(board, value);\n            } else {\n                return setValue(board, control, value);\n            }\n        }\n        if (board.hasSandwichSelected()) {\n            return setSandwichValue(board, +String.fromCharCode(e.keyCode));\n        }\n        return NO_OP;\n    }\n\n    switch (e.keyCode) {\n        case KeyCode.KEY_SPACE:\n            return unsetValue(board);\n        case KeyCode.KEY_BACK_SPACE:\n            e.preventDefault();\n            return pressBackspace(board);\n        case KeyCode.KEY_DOWN:\n            return move(board, control, +1, 0);\n        case KeyCode.KEY_UP:\n            return move(board, control, -1, 0);\n        case KeyCode.KEY_LEFT:\n            return move(board, control, 0, -1);\n        case KeyCode.KEY_RIGHT:\n            return move(board, control, 0, +1);\n        case KeyCode.KEY_ESCAPE:\n            return pressEsc(board);\n        case KeyCode.KEY_Z:\n        case KeyCode.KEY_U:\n            return undo(history);\n        case KeyCode.KEY_Y:\n        case KeyCode.KEY_R:\n            return redo(history);\n        default:\n    }\n    return NO_OP;\n}\n\nexport const color = (board: BoardModel, color: number | null): ActionTypes => {\n    let newBoard = _.cloneDeep(board);\n    newBoard.colorSelectedCells(color);\n    return updateBoard(newBoard);\n}\n\nexport const clearAllColors = (board: BoardModel): ActionTypes => {\n    let newBoard = _.cloneDeep(board);\n    newBoard.clearAllColors();\n    return updateBoard(newBoard);\n}\n","import React from 'react';\nimport { CellModel, CellValue } from '../../models/cell';\n\n\ntype CellProps = {\n    cell: CellModel,\n    onClick: (e: any) => void,\n    onMouseDown: (e: any) => void,\n    onMouseOver: (e: any) => void,\n    key: string,\n    highlightMatching: CellValue,\n};\n\nclass Cell extends React.Component<CellProps> {\n    renderCellMainValue() {\n        if (this.props.cell.value) {\n            return (\n                <span className=\"cell-main-value\">\n                    {this.props.cell.value}\n                </span>\n            );\n        }\n        return;\n    }\n\n    shouldHighlightMatching(value: CellValue) {\n        return this.props.highlightMatching && value === this.props.highlightMatching;\n    }\n\n    renderCellCornerValues() {\n        if (this.props.cell.value) {\n            // Do not show corner values, if cell is filled.\n            return;\n        }\n        const sortedValues = Array.from(this.props.cell.cornerValues)\n            .sort()\n            .map((value) => {\n                const classes = this.shouldHighlightMatching(value) ? 'matching' : '';\n                return (\n                    <span\n                        className={classes}\n                        key={\"corner-\" + this.props.cell.id + \"-\" + value}\n                    >\n                        {value}\n                    </span>\n                );\n            });\n        return (\n            <span className=\"cell-corner-value\">\n                {sortedValues}\n            </span>\n        );\n    }\n\n    renderCellCenterValues() {\n        if (this.props.cell.value) {\n            // Do not show center values, if cell is filled.\n            return;\n        }\n        const sortedValues = Array.from(this.props.cell.centerValues)\n            .sort()\n            .map((value) => {\n                const classes = this.shouldHighlightMatching(value) ? 'matching' : '';\n                return (\n                    <span\n                        className={classes}\n                        key={\"center-\" + this.props.cell.id + \"-\" + value}\n                    >\n                        {value}\n                    </span>\n                );\n            });\n        return (\n            <span className=\"cell-center-value\">\n                {sortedValues}\n            </span>\n        );\n    }\n\n    render() {\n        let classes = ['cell'];\n\n        // Add border based on region position.\n        if (this.props.cell.isRegionTop()) {\n            classes.push('region-top');\n        }\n        if (this.props.cell.isRegionLeft()) {\n            classes.push('region-left');\n        }\n\n        // Add border based on board position.\n        if (this.props.cell.isBoardLeft()) {\n            classes.push('board-left');\n        }\n        if (this.props.cell.isBoardRight()) {\n            classes.push('board-right');\n        }\n        if (this.props.cell.isBoardTop()) {\n            classes.push('board-top');\n        }\n        if (this.props.cell.isBoardBottom()) {\n            classes.push('board-bottom');\n        }\n\n        // Add highlighting class.\n        if (this.props.cell.selected) {\n            classes.push('selected');\n        } else if (this.shouldHighlightMatching(this.props.cell.value)) {\n            classes.push('matching');\n        } else if (this.props.cell.restricted) {\n            classes.push('restricted');\n        } else if (this.props.cell.isFixed) {\n            classes.push('fixed');\n        } else if (this.props.cell.error) {\n            classes.push('error');\n        }\n\n        let innerClasses = [\"cell-inner\"];\n        if (this.props.cell.color !== null && !this.props.cell.error) {\n            innerClasses.push(`color-${this.props.cell.color}`);\n        }\n\n        return (\n            <div\n                className={classes.join(' ')}\n                onClick={this.props.onClick}\n                onMouseDown={this.props.onMouseDown}\n                onTouchStart={this.props.onMouseDown}\n                onMouseOver={this.props.onMouseOver}\n                onTouchMove={this.props.onMouseOver}\n                key={this.props.cell.id}\n            >\n                <div className={innerClasses.join(' ')}>\n                    {this.renderCellMainValue()}\n                    {this.renderCellCornerValues()}\n                    {this.renderCellCenterValues()}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default Cell;\n","export const sumToSeqs: any = {\n    0: [[]],\n    2: [\n        [2],\n    ],\n    3: [\n        [3],\n    ],\n    4: [\n        [4],\n    ],\n    5: [\n        [5],\n        [2, 3],\n    ],\n    6: [\n        [6],\n        [2, 4],\n    ],\n    7: [\n        [7],\n        [2, 5],\n        [3, 4],\n    ],\n    8: [\n        [8],\n        [2, 6],\n        [3, 5],\n    ],\n    9: [\n        [2, 7],\n        [3, 6],\n        [4, 5],\n        [2, 3, 4],\n    ],\n    10: [\n        [2, 8],\n        [3, 7],\n        [4, 6],\n        [2, 3, 5],\n    ],\n    11: [\n        [3, 8],\n        [4, 7],\n        [5, 6],\n        [2, 3, 6],\n        [2, 4, 5],\n    ],\n    12: [\n        [4, 8],\n        [5, 7],\n        [2, 3, 7],\n        [2, 4, 6],\n        [3, 4, 5],\n    ],\n    13: [\n        [5, 8],\n        [6, 7],\n        [2, 3, 8],\n        [2, 4, 7],\n        [2, 5, 6],\n        [3, 4, 6],\n    ],\n    14: [\n        [6, 8],\n        [2, 4, 8],\n        [2, 5, 7],\n        [3, 4, 7],\n        [3, 5, 6],\n        [2, 3, 4, 5],\n    ],\n    15: [\n        [7, 8],\n        [2, 5, 8],\n        [2, 6, 7],\n        [3, 4, 8],\n        [3, 5, 7],\n        [4, 5, 6],\n        [2, 3, 4, 6],\n    ],\n    16: [\n        [2, 6, 8],\n        [3, 5, 8],\n        [3, 6, 7],\n        [4, 5, 7],\n        [2, 3, 4, 7],\n        [2, 3, 5, 6],\n    ],\n    17: [\n        [2, 7, 8],\n        [3, 6, 8],\n        [4, 5, 8],\n        [4, 6, 7],\n        [2, 3, 4, 8],\n        [2, 3, 5, 7],\n        [2, 4, 5, 6],\n    ],\n    18: [\n        [3, 7, 8],\n        [4, 6, 8],\n        [5, 6, 7],\n        [2, 3, 5, 8],\n        [2, 3, 6, 7],\n        [2, 4, 5, 7],\n        [3, 4, 5, 6],\n    ],\n    19: [\n        [4, 7, 8],\n        [5, 6, 8],\n        [2, 3, 6, 8],\n        [2, 4, 5, 8],\n        [2, 4, 6, 7],\n        [3, 4, 5, 7],\n    ],\n    20: [\n        [5, 7, 8],\n        [2, 3, 7, 8],\n        [2, 4, 6, 8],\n        [2, 5, 6, 7],\n        [3, 4, 5, 8],\n        [3, 4, 6, 7],\n        [2, 3, 4, 5, 6],\n    ],\n    21: [\n        [6, 7, 8],\n        [2, 4, 7, 8],\n        [2, 5, 6, 8],\n        [3, 4, 6, 8],\n        [3, 5, 6, 7],\n        [2, 3, 4, 5, 7],\n    ],\n    22: [\n        [2, 5, 7, 8],\n        [3, 4, 7, 8],\n        [3, 5, 6, 8],\n        [4, 5, 6, 7],\n        [2, 3, 4, 5, 8],\n        [2, 3, 4, 6, 7],\n    ],\n    23: [\n        [2, 6, 7, 8],\n        [3, 5, 7, 8],\n        [4, 5, 6, 8],\n        [2, 3, 4, 6, 8],\n        [2, 3, 5, 6, 7],\n    ],\n    24: [\n        [3, 6, 7, 8],\n        [4, 5, 7, 8],\n        [2, 3, 4, 7, 8],\n        [2, 3, 5, 6, 8],\n        [2, 4, 5, 6, 7],\n    ],\n    25: [\n        [4, 6, 7, 8],\n        [2, 3, 5, 7, 8],\n        [2, 4, 5, 6, 8],\n        [3, 4, 5, 6, 7],\n    ],\n    26: [\n        [5, 6, 7, 8],\n        [2, 3, 6, 7, 8],\n        [2, 4, 5, 7, 8],\n        [3, 4, 5, 6, 8],\n    ],\n    27: [\n        [2, 4, 6, 7, 8],\n        [3, 4, 5, 7, 8],\n        [2, 3, 4, 5, 6, 7],\n    ],\n    28: [\n        [2, 5, 6, 7, 8],\n        [3, 4, 6, 7, 8],\n        [2, 3, 4, 5, 6, 8],\n    ],\n    29: [\n        [3, 5, 6, 7, 8],\n        [2, 3, 4, 5, 7, 8],\n    ],\n    30: [\n        [4, 5, 6, 7, 8],\n        [2, 3, 4, 6, 7, 8],\n    ],\n    31: [\n        [2, 3, 5, 6, 7, 8],\n    ],\n    32: [\n        [2, 4, 5, 6, 7, 8],\n    ],\n    33: [\n        [3, 4, 5, 6, 7, 8],\n    ],\n    35: [\n        [2, 3, 4, 5, 6, 7, 8],\n    ],\n};\nexport const sandwichLengths: any = {\n    0: [0],\n    2: [1],\n    3: [1],\n    4: [1],\n    5: [1, 2],\n    6: [1, 2],\n    7: [1, 2],\n    8: [1, 2],\n    9: [2, 3],\n    10: [2, 3],\n    11: [2, 3],\n    12: [2, 3],\n    13: [2, 3],\n    14: [2, 3, 4],\n    15: [2, 3, 4],\n    16: [3, 4],\n    17: [3, 4],\n    18: [3, 4],\n    19: [3, 4],\n    20: [3, 4, 5],\n    21: [3, 4, 5],\n    22: [4, 5],\n    23: [4, 5],\n    24: [4, 5],\n    25: [4, 5],\n    26: [4, 5],\n    27: [5, 6],\n    28: [5, 6],\n    29: [5, 6],\n    30: [5, 6],\n    31: [6],\n    32: [6],\n    33: [6],\n    35: [7],\n};\n\n/** Generated by C++ code:\n\n#include \"bits/stdc++.h\"\nusing namespace std;\n\nusing Seq = vector<int>;\n\nvoid attempt(Seq& cur, int len, map<int, vector<Seq>>& res) {\n    if (cur.size() == len) {\n        int sum = accumulate(cur.begin(), cur.end(), 0);\n        res[sum].push_back(cur);\n        return;\n    }\n\n    int last = cur.empty() ? 1 : cur.back();\n    for (int val = last + 1; val <= 8; val++) {\n        cur.push_back(val);\n        attempt(cur, len, res);\n        cur.pop_back();\n    }\n}\n\nstring join(const Seq& seq, const string& sep) {\n    bool first = true;\n    stringstream ss;\n    for (auto val : seq) {\n        if (first) first = false;\n        else ss << sep;\n        ss << val;\n    }\n    return ss.str();\n}\n\nint main() {\n    map<int, vector<Seq>> res;\n    res[0].push_back({});\n    for (int len = 1; len <= 7; len++) {\n        Seq cur;\n        attempt(cur, len, res);\n    }\n\n    cout << \"export const sumToSeqs = {\" << endl;\n    for (auto [sum, seqs] : res) {\n        cout << \"    \" << sum << \": [\" << endl;\n        for (auto seq : seqs) {\n            cout << \"        [\";\n            cout << join(seq, \", \");\n            cout << \"],\" << endl;\n        }\n        cout << \"    ],\" << endl;\n    }\n    cout << \"};\" << endl;\n\n    cout << \"export const sandwichLengths = {\" << endl;\n    for (auto [sum, seqs] : res) {\n        vector<int> possible_lens;\n        for (auto seq : seqs) {\n            possible_lens.push_back(seq.size());\n        }\n        possible_lens.resize(unique(possible_lens.begin(), possible_lens.end()) - possible_lens.begin());\n        cout << \"    \" << sum << \": [\" << join(possible_lens, \", \") << \"],\" << endl;\n    }\n    cout << \"};\" << endl;\n    return 0;\n}\n\n*/","import React from 'react';\nimport { QuestionSquare } from 'react-bootstrap-icons';\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\nimport Tooltip from 'react-bootstrap/Tooltip';\nimport { connect, ConnectedProps } from 'react-redux';\nimport { SandwichCellModel } from '../../models/sandwichCell';\nimport { sumToSeqs } from '../../utils/sandwich';\nimport { GameState } from '../Game';\n\n\nclass SandwichCell extends React.Component<SandwichCellProps> {\n    renderSandwichHint() {\n        if (!this.props.sandwichHint || this.props.value.value === null || this.props.value.value === 0) {\n            return;\n        }\n\n        const seqs = sumToSeqs[this.props.value.value].map((seq: Array<number>, index: number) => {\n            return (\n                <div key={`tooltip-sandwich-${this.props.value.id}-${index}`}>\n                    {seq.join(' ')}\n                </div>\n            );\n        });\n        const tooltip = (\n            <Tooltip id={`tooltip-sandwich-${this.props.value.id}`}>\n                <div>{seqs}</div>\n            </Tooltip>\n        );\n        return (\n            <div className=\"sandwich-corner-value\">\n                <OverlayTrigger\n                    placement=\"right\"\n                    overlay={tooltip}>\n                    <QuestionSquare />\n                </OverlayTrigger>\n            </div>\n        );\n    }\n\n    render() {\n        let defaultValue = (this.props.value.value === null) ? undefined : this.props.value.value;\n\n        let classes = ['sandwich-cell'];\n        if (this.props.value.color !== null) {\n            classes.push(`color-${this.props.value.color}`);\n        } else if (this.props.value.selected) {\n            classes.push('selected');\n        } else if (this.props.value.isFixed) {\n            classes.push('fixed');\n        }\n        if (this.props.value.error) {\n            classes.push('error');\n        }\n\n\n        return (\n            <div\n                onClick={this.props.onClick}\n                className={classes.join(' ')}\n            >\n                <div className='cell-main-value'>\n                    {defaultValue}\n                </div>\n                {this.renderSandwichHint()}\n            </div>\n        );\n    }\n}\n\nconst mapStateToProps = (state: GameState) => {\n    return {\n        sandwichHint: state.control.displayOptions.sandwichHint,\n    };\n};\n\nconst connector = connect(mapStateToProps);\ntype SandwichCellProps = ConnectedProps<typeof connector> & {\n    value: SandwichCellModel,\n    onClick: (e: any) => void,\n}\n\nexport default connector(SandwichCell);\n","import React from 'react';\nimport { BoardModel } from '../../models/board';\nimport { GameOptions } from '../../models/control';\nimport Cell from './Cell';\nimport SandwichCell from './SandwichCell';\n\n\nclass Board extends React.Component<BoardProps> {\n    renderCell(i: number) {\n        return (\n            <Cell\n                cell={this.props.board.cells[i]}\n                onClick={(e) => this.props.onClick(e, i)}\n                onMouseDown={(e) => this.props.onMouseDown(e, i)}\n                onMouseOver={() => this.props.onMouseOver(i)}\n                key={String(i)}\n                highlightMatching={this.props.board.highlightMatching}\n            />\n        );\n    }\n\n    renderSandwichCell(isRow: boolean, id: number, key: string) {\n        const value = (isRow) ? this.props.board.rowSandwich[id] : this.props.board.colSandwich[id];\n        return (\n            <SandwichCell\n                value={value}\n                key={key}\n                onClick={(e) => this.props.onSelectSandwich(e, isRow, id)}\n            />\n        );\n    }\n    \n    renderEmptySandwichCell() {\n        return (\n            <div className=\"sandwich-cell\"></div>\n        );\n    }\n\n    renderRow(rowId: number) {\n        const startingCell = rowId * 9;\n        const cells = [...Array(9).keys()].map(x => this.renderCell(startingCell + x));\n\n        let sandwichCell = null;\n        if (this.props.gameOptions.sandwich) {\n            sandwichCell = this.renderSandwichCell(\n                true, rowId, `sandwich-row-${rowId}`);\n        }\n\n        return (\n            <div className=\"row\" key={startingCell}>\n                {sandwichCell}\n                {cells}\n            </div>\n        );\n    }\n\n    renderSandwichRow() {\n        const sandwichCells = [...Array(9).keys()].map(\n            x => this.renderSandwichCell(false, x, `sandwich-col-${x}`));\n\n        return (\n            <div className=\"row\">\n                {this.renderEmptySandwichCell()}\n                {sandwichCells}\n            </div>\n        );\n    }\n\n    render() {\n        let sandwichRow = null;\n        if (this.props.gameOptions.sandwich) {\n            sandwichRow = this.renderSandwichRow();\n        }\n\n        const rows = [...Array(9).keys()].map(x => this.renderRow(x));\n        return (\n            <div>\n                {sandwichRow}\n                {rows}\n            </div>\n        );\n    }\n}\n\ntype BoardProps = {\n    board: BoardModel,\n    gameOptions: GameOptions,\n    onClick: (e: any, i: number) => void,\n    onSelectSandwich: (e: any, isRow: boolean, i: number) => void,\n    onMouseDown: (e: any, i: number) => void,\n    onMouseOver: (i: number) => void,\n};\n\n\nexport default Board;\n","// Return: number of bit 1 of `n`.\nexport const bitCount = (n: number): number => {\n    n = n - ((n >> 1) & 0x55555555)\n    n = (n & 0x33333333) + ((n >> 2) & 0x33333333)\n    return ((n + (n >> 4) & 0xF0F0F0F) * 0x1010101) >> 24\n}\n\n// Return: true if the corresponding bit of n is 1.\nexport const bitContains = (n: number, bit: number): boolean => {\n    return ((n >> bit) & 1) > 0;\n}\n\n// Return: copy of n with corresponding bit set to 0.\nexport const bitRemoveIfExists = (n: number, bit: number): number => {\n    if (!bitContains(n, bit)) {\n        return n;\n    }\n    return n - (1<<bit);\n}\n","import SortedSet from 'collections/sorted-set';\nimport _ from 'lodash';\nimport { BoardModel } from '../models/board';\nimport { CellValue } from '../models/cell';\nimport { ControlModel } from '../models/control';\nimport { bitContains, bitCount } from './bits';\nimport { sandwichLengths, sumToSeqs } from './sandwich';\n\nconst toRowId = (cellId: number) => {\n    return ~~(cellId / 9);\n};\nconst toColId = (cellId: number) => {\n    return cellId % 9;\n};\nconst toCellId = (rowId: number, colId: number) => {\n    return rowId * 9 + colId;\n};\n\nconst getRowValues = (rowId: number, values: Array<number>): Array<number> => {\n    return values.slice(rowId * 9, rowId * 9 + 9);\n}\n\nconst getColValues = (colId: number, values: Array<number>): Array<number> => {\n    let res = [];\n    for (let i = colId; i < 81; i += 9) {\n        res.push(values[i]);\n    }\n    return res;\n}\n\nconst equals = (a: [number, number], b: [number, number]): boolean => {\n    return a[0] === b[0] && a[1] === b[1];\n};\nconst compare = (a: [number, number], b: [number, number]): number => {\n    if (a[0] !== b[0]) {\n        return a[0] - b[0];\n    }\n    return a[1] - b[1];\n}\n\nclass CandidateStore {\n    candidates: Array<number>;\n    set: SortedSet<[number, number]>;\n\n    constructor(_candidates: Array<number>) {\n        this.candidates = _candidates.map(candidate => (candidate <= 0 ? -1 : candidate));\n        this.set = new SortedSet(\n            [],\n            equals,\n            compare\n        );\n\n        for (let i = 0; i < 81; i++) {\n            if (_candidates[i] > 0) {\n                this.set.add([bitCount(_candidates[i]), i]);\n            }\n        }\n    }\n\n    hasCandidate(cellId: number, candidate: number): boolean {\n        if (this.candidates[cellId] < 0) return false;\n        return bitContains(this.candidates[cellId], candidate);\n    }\n\n    getCandidates(cellId: number): Array<number> {\n        if (this.candidates[cellId] < 0) {\n            return [];\n        }\n\n        let res = [];\n        for (let i = 1; i <= 9; i++) {\n            if (this.hasCandidate(cellId, i)) {\n                res.push(i);\n            }\n        }\n        return res;\n    }\n\n    getBestCell(): [number, number] {\n        let minNode = this.set.min();\n        if (minNode) {\n            return minNode;\n        }\n        return [-1, -1];\n    }\n\n    setCandidate(cellId: number, newValue: number) {\n        if (this.candidates[cellId] < 0) return;\n\n        this.set.remove([bitCount(this.candidates[cellId]), cellId]);\n        this.candidates[cellId] = newValue;\n        this.set.add([bitCount(newValue), cellId]);\n    }\n\n    addCandidate(cellId: number, candidate: number) {\n        if (this.candidates[cellId] < 0) return;\n        if (bitContains(this.candidates[cellId], candidate)) {\n            return;\n        }\n        this.setCandidate(cellId, this.candidates[cellId] + (1 << candidate));\n    }\n\n    removeCandidate(cellId: number, candidate: number) {\n        if (this.candidates[cellId] < 0) return;\n        if (!bitContains(this.candidates[cellId], candidate)) {\n            return;\n        }\n        this.setCandidate(cellId, this.candidates[cellId] - (1 << candidate));\n    }\n\n    removeCell(cellId: number) {\n        if (this.candidates[cellId] < 0) return;\n\n        this.set.remove([bitCount(this.candidates[cellId]), cellId]);\n        this.candidates[cellId] = -1;\n    }\n};\n\n// Input:\n// - sum = sandwich sum for this row / column.\n// - values = numbers in this row / column. If missing --> 0.\n//\n// Return:\n// - Set of possible values inside sandwich,\n// - Set of possible values outside sandwich.\nconst getValidSandwichValues = (sum: number, values: Array<number>): [Set<number>, Set<number>] => {\n    if (sum === 0) {\n        return [new Set(), new Set([1, 2, 3, 4, 5, 6, 7, 8, 9])];\n    }\n\n    let left = values.indexOf(1);\n    let right = values.indexOf(9);\n    if (left > right) {\n        [left, right] = [right, left];\n    }\n    const len = right - left - 1;\n\n    // What we know about the seqs\n    let mustHave: Set<number> = new Set();\n    let mustNot: Set<number> = new Set();\n    let inside = false;\n    for (let value of values) {\n        if (value === 0) continue;\n\n        if (value === 1 || value === 9) {\n            inside = !inside;\n        } else {\n            if (inside) mustHave.add(value);\n            else mustNot.add(value);\n        }\n    }\n\n    // Check all seqs with this sum.\n    let insides: Set<number> = new Set();\n    let outsides: Set<number> = new Set();\n    for (let seq of sumToSeqs[sum]) {\n        const seq_set = new Set(seq);\n        let can = true;\n        if (seq.length !== len) {\n            can = false;\n        }\n        for (let value of mustHave) {\n            if (!seq_set.has(value)) {\n                can = false;\n                break;\n            }\n        }\n        for (let value of mustNot) {\n            if (seq_set.has(value)) {\n                can = false;\n                break;\n            }\n        }\n        if (can) {\n            for (let value = 1; value <= 9; value++) {\n                if (seq_set.has(value)) {\n                    insides.add(value);\n                } else {\n                    outsides.add(value);\n                }\n            }\n        }\n    }\n    return [insides, outsides];\n}\n\n// Assumption: we have just filled number in cell (rowId, colId).\n// We want to use sandwich clue in that row / column to eliminiate some candidates.\nconst applySandwichClues = (\n        board: BoardModel,\n        rowId: number,\n        colId: number,\n        values: Array<number>,\n        candidateStore: CandidateStore\n        ): void => {\n    // For row.\n    if (board.rowSandwich[rowId].value !== null) {\n        const row = getRowValues(rowId, values);\n        const sandwichSum: number = board.rowSandwich[rowId].value as number;\n\n        if (row.indexOf(1) >= 0 && row.indexOf(9) >= 0) {\n            const [insides, outsides] = getValidSandwichValues(sandwichSum, row);\n            let inside = false;\n            for (let i = 0; i < 9; i++) {\n                if (row[i] === 1 || row[i] === 9) {\n                    inside = !inside;\n                } else if (row[i] === 0) {\n                    for (let value = 1; value <= 9; value++) {\n                        const cellId = toCellId(rowId, i);\n                        if ((inside && !insides.has(value))\n                                || (!inside && !outsides.has(value))) {\n                            candidateStore.removeCandidate(cellId, value);\n                        }\n                    }\n                }\n            }\n        } else if (row.indexOf(1) >= 0 || row.indexOf(9) >= 0) {\n            let indexOf19 = row.indexOf(1);\n            if (indexOf19 < 0) indexOf19 = row.indexOf(9);\n\n            const possibleLens = new Set(sandwichLengths[sandwichSum]);\n            for (let i = 0; i < 9; i++) {\n                if (row[i] === 0) {\n                    if (!possibleLens.has(Math.abs(i - indexOf19) - 1)) {\n                        const cellId = toCellId(rowId, i);\n                        candidateStore.removeCandidate(cellId, 1);\n                        candidateStore.removeCandidate(cellId, 9);\n                    }\n                }\n            }\n        }\n    }\n\n    // For column.\n    if (board.colSandwich[colId].value !== null) {\n        const col = getColValues(colId, values);\n        const sandwichSum: number = board.colSandwich[colId].value as number;\n\n        if (col.indexOf(1) >= 0 && col.indexOf(9) >= 0) {\n            const [insides, outsides] = getValidSandwichValues(sandwichSum, col);\n            let inside = false;\n            for (let i = 0; i < 9; i++) {\n                if (col[i] === 1 || col[i] === 9) {\n                    inside = !inside;\n                } else if (col[i] === 0) {\n                    for (let value = 1; value <= 9; value++) {\n                        const cellId = toCellId(i, colId);\n                        if ((inside && !insides.has(value))\n                                || (!inside && !outsides.has(value))) {\n                            candidateStore.removeCandidate(cellId, value);\n                        }\n                    }\n                }\n            }\n        } else if (col.indexOf(1) >= 0 || col.indexOf(9) >= 0) {\n            let indexOf19 = col.indexOf(1);\n            if (indexOf19 < 0) indexOf19 = col.indexOf(9);\n\n            const possibleLens = new Set(sandwichLengths[sandwichSum]);\n            for (let i = 0; i < 9; i++) {\n                if (col[i] === 0) {\n                    if (!possibleLens.has(Math.abs(i - indexOf19) - 1)) {\n                        const cellId = toCellId(i, colId);\n                        candidateStore.removeCandidate(cellId, 1);\n                        candidateStore.removeCandidate(cellId, 9);\n                    }\n                }\n            }\n        }\n    }\n};\n\n// Input:\n// - board, control: model instances, so that we can get visible cells of a cell.\n// - values: array with length 9*9, representing the filled values board.\n// - candidates: array with length 9*9, where each element is a bitmask representing possible values for that cell.\n// \n// Return: array of 2 elements:\n// - First element is either a solution or null\n// - Number of solutions we find. We always break at >= 2 solutions.\nconst attempt = (\n        board: BoardModel,\n        control: ControlModel,\n        values: Array<number>,\n        candidateStore: CandidateStore,\n        ): [BoardModel | null, number] => {\n    \n    // Find cell with minimum number of candidates.\n    let [cntCandidates, cellId] = candidateStore.getBestCell();\n\n    if (cntCandidates === 0) {\n        return [null, 0];\n    }\n    if (cntCandidates < 0) {\n        let solution = _.cloneDeep(board);\n        for (let i = 0; i < 81; i++) {\n            if (values[i] === 0) {\n                throw new Error(`Invalid state: cannot find a value for cell ID ${i}`);\n            }\n            solution.setValueOfSingleCell(i, String.fromCharCode(48 + values[i]) as CellValue, control.gameOptions, false);\n        }\n        return [solution, 1];\n    }\n\n    let firstSolution = null;\n    let cntSolutions = 0;\n\n    let candidates = candidateStore.getCandidates(cellId);\n    for (let value of candidates) {\n        const saveValues = _.clone(values);\n        const saveCandidates = _.clone(candidateStore.candidates);\n\n        values[cellId] = value;\n        candidateStore.removeCell(cellId);\n        const neighborIds = board.getVisibleCells(cellId, control.gameOptions);\n        for (let neighborId of neighborIds) {\n            candidateStore.removeCandidate(neighborId, value);\n        };\n        if (control.gameOptions.sandwich) {\n            applySandwichClues(board, toRowId(cellId), toColId(cellId), values, candidateStore);\n        }\n\n        let [solution, cnt] = attempt(board, control, values, candidateStore);\n        if (cnt > 0) {\n            if (firstSolution === null) {\n                firstSolution = solution;\n            }\n            cntSolutions += cnt;\n            if (cntSolutions >= 2) {\n                break;\n            }\n        }\n\n        values = saveValues;\n        candidateStore = new CandidateStore(saveCandidates);\n    }\n    return [firstSolution, cntSolutions];\n};\n\n// Input:\n// - board: A Sandwich Sudoku board.\n// - control: ControlModel instance.\n// - values: array with length 9*9, representing the filled values board.\n// - candidates: array with length 9*9, where each element is a bitmask representing possible values for that cell.\n//\n// Return: array of 2 elements:\n// - First element is either a solution or null\n// - Number of solutions we find. We always break at >= 2 solutions.\nconst attemptSandwich = (\n        board: BoardModel,\n        control: ControlModel,\n        values: Array<number>,\n        candidateStore: CandidateStore\n        ): [BoardModel | null, number] => {\n    // Find row / column with least number of candidates for 1/9.\n    let bestCount = 1000;\n    let isRow = false;\n    let bestId = -1;\n    let oneOrNine = 1;\n    for (let i = 0; i < 9; i++) {\n        // row\n        if (board.rowSandwich[i].value !== null) {\n            let cnt1 = 0;\n            let cnt9 = 0;\n            for (let col = 0; col < 9; col++) {\n                const cellId = toCellId(i, col);\n                if (values[cellId] === 0) {\n                    if (candidateStore.hasCandidate(cellId, 1)) cnt1 += 1;\n                    if (candidateStore.hasCandidate(cellId, 9)) cnt9 += 1;\n                }\n            }\n            if (cnt1 > 0 && cnt1 < bestCount) {\n                bestCount = cnt1;\n                isRow = true;\n                bestId = i;\n                oneOrNine = 1;\n            }\n            if (cnt9 > 0 && cnt9 < bestCount) {\n                bestCount = cnt9;\n                isRow = true;\n                bestId = i;\n                oneOrNine = 9;\n            }\n        }\n        // col\n        if (board.colSandwich[i].value !== null) {\n            let cnt1 = 0;\n            let cnt9 = 0;\n            for (let row = 0; row < 9; row++) {\n                const cellId = toCellId(row, i);\n                if (values[cellId] === 0) {\n                    if (candidateStore.hasCandidate(cellId, 1)) cnt1 += 1;\n                    if (candidateStore.hasCandidate(cellId, 9)) cnt9 += 1;\n                }\n            }\n            if (cnt1 > 0 && cnt1 < bestCount) {\n                bestCount = cnt1;\n                isRow = false;\n                bestId = i;\n                oneOrNine = 1;\n            }\n            if (cnt9 > 0 && cnt9 < bestCount) {\n                bestCount = cnt9;\n                isRow = false;\n                bestId = i;\n                oneOrNine = 9;\n            }\n        }\n    }\n\n    if (bestId < 0) {\n        // No row / column with sandwich clue has missing 1/9.\n        return attempt(board, control, values, candidateStore);\n    }\n\n    // Check whether some cells have become invalid.\n    let cntCandidates = candidateStore.getBestCell()[0];\n    if (cntCandidates === 0) {\n        return [null, 0];\n    }\n\n    let firstSolution = null;\n    let cntSolutions = 0;\n    for (let i = 0; i < 9; i++) {\n        const cellId = isRow ? toCellId(bestId, i) : toCellId(i, bestId);\n\n        if (values[cellId] === 0 && candidateStore.hasCandidate(cellId, oneOrNine)) {\n            const saveValues = _.clone(values);\n            const saveCandidates = _.clone(candidateStore.candidates);\n\n            values[cellId] = oneOrNine;\n            candidateStore.removeCell(cellId);\n            const neighborIds = board.getVisibleCells(cellId, control.gameOptions);\n            for (let neighborId of neighborIds) {\n                candidateStore.removeCandidate(neighborId, oneOrNine)\n            };\n            if (control.gameOptions.sandwich) {\n                applySandwichClues(board, toRowId(cellId), toColId(cellId), values, candidateStore);\n            }\n            let [solution, cnt] = attemptSandwich(board, control, values, candidateStore);\n            if (cnt > 0) {\n                if (firstSolution === null) {\n                    firstSolution = solution;\n                }\n                cntSolutions += cnt;\n                if (cntSolutions >= 2) {\n                    break;\n                }\n            }\n\n            values = saveValues;\n            candidateStore = new CandidateStore(saveCandidates);\n        }\n    }\n    return [firstSolution, cntSolutions];\n}\n\nexport const solveBoard = (board: BoardModel, control: ControlModel): [BoardModel | null, number] => {\n    let newBoard = _.cloneDeep(board);\n    newBoard.fillAllPossibleValues(control.gameOptions);\n\n    let values = newBoard.cells.map(cell => {\n        if (!cell.value) return 0;\n        else return +cell.value;\n    });\n    let candidates = newBoard.cells.map(cell => {\n        if (cell.value !== null) {\n            return 0;\n        }\n        let mask = 0;\n        for (let value of cell.centerValues) {\n            if (value !== null) {\n                mask += 1 << (+value);\n            }\n        }\n        return mask;\n    });\n\n    // Use sandwich clues for filled cells.\n    if (control.gameOptions.sandwich) {\n        for (let i = 0; i < 9; i++) {\n            if (!newBoard.rowSandwich[i].isValid()) {\n                return [null, 0];\n            }\n            if (!newBoard.colSandwich[i].isValid()) {\n                return [null, 0];\n            }\n        }\n        let candidateStore = new CandidateStore(candidates);\n        for (let i = 0; i < 81; i++) {\n            if (values[i] > 0) {\n                applySandwichClues(newBoard, toRowId(i), toColId(i), values, candidateStore);\n            }\n        }\n        return attemptSandwich(newBoard, control, values, candidateStore);\n    }\n\n    return attempt(newBoard, control, values, new CandidateStore(candidates));\n};\n","import React from 'react';\nimport Form from 'react-bootstrap/Form';\nimport { connect, ConnectedProps } from 'react-redux';\nimport { updateDisplay } from '../../actions/control';\nimport { GameState } from '../Game';\n\n\nclass DisplayOptions extends React.Component<DisplayOptionsProps> {\n    renderSandwichDisplayOptions() {\n        if (this.props.sandwich) {\n            return (\n                <Form.Check\n                    type='checkbox'\n                    id='checkbox-sandwich-hint'\n                    label='Show Sandwich sum hints'\n                    checked={this.props.sandwichHint}\n                    onChange={() => this.props.updateDisplay({\n                        ...this.props,\n                        sandwichHint: !this.props.sandwichHint\n                    })}\n                />\n            );\n        }\n        return null;\n    }\n\n    render() {\n        return (\n            <div id=\"display-options\">\n                <h4>Display Options</h4>\n                <Form.Check\n                    type='checkbox'\n                    id='checkbox-highlight-restricted'\n                    label='Highlight restricted cells'\n                    checked={this.props.highlightRestricted}\n                    onChange={() => this.props.updateDisplay({\n                        ...this.props,\n                        highlightRestricted: !this.props.highlightRestricted\n                    })}\n                />\n                <Form.Check\n                    type='checkbox'\n                    id='checkbox-highlight-matching-numbers'\n                    label='Highlight matching numbers'\n                    checked={this.props.highlightMatchingNumbers}\n                    onChange={() => this.props.updateDisplay({\n                        ...this.props,\n                        highlightMatchingNumbers: !this.props.highlightMatchingNumbers\n                    })}\n                />\n                <Form.Check\n                    type='checkbox'\n                    id='checkbox-auto-cleanup'\n                    label='Auto Cleanup corner &amp; center values'\n                    checked={this.props.autoCleanUp}\n                    onChange={() => this.props.updateDisplay({\n                        ...this.props,\n                        autoCleanUp: !this.props.autoCleanUp\n                    })}\n                />\n                {this.renderSandwichDisplayOptions()}\n            </div>\n        );\n    }\n}\n\nconst mapStateToProps = (state: GameState) => {\n    return {...state.control.displayOptions, ...state.control.gameOptions};\n};\n\nconst connector = connect(mapStateToProps, { updateDisplay });\n\ntype DisplayOptionsProps = ConnectedProps<typeof connector>;\n\nexport default connector(DisplayOptions);\n","import _ from 'lodash';\nimport { BoardModel } from '../models/board';\nimport { ControlModel, DisplayOptions, GameOptions } from '../models/control';\nimport { solveBoard } from '../utils/solver';\nimport { updateBoard } from './board';\nimport {\n    ACTION_GENERATE_URL,\n    ACTION_UPDATE_DISPLAY,\n    ACTION_UPDATE_GAME_PLAY as ACTION_UPDATE_GAME_OPTIONS,\n    ActionTypes,\n    NO_OP\n    } from './types';\n\n\n\nexport const fillCenter = (board: BoardModel, control: ControlModel): ActionTypes => {\n    let newBoard = _.cloneDeep(board);\n    newBoard.fillAllPossibleValues(control.gameOptions);\n    return updateBoard(newBoard);\n}\n\nexport const updateDisplay = (displayOptions: DisplayOptions): ActionTypes => {\n    return {\n        type: ACTION_UPDATE_DISPLAY,\n        payload: displayOptions,\n    };\n};\n\nexport const updateGameOptions = (gameOptions: GameOptions): ActionTypes => {\n    return {\n        type: ACTION_UPDATE_GAME_OPTIONS,\n        payload: gameOptions,\n    }\n};\n\nexport const verify = (board: BoardModel, control: ControlModel): ActionTypes => {\n    let newBoard = _.cloneDeep(board);\n    newBoard.clearAllSelections();\n    newBoard.clearAllRestricteds();\n    newBoard.clearAllErrors();\n    let invalidCellIds = newBoard.getInvalidCellIds(control.gameOptions);\n    newBoard.setErrors(invalidCellIds);\n\n    let hasError = invalidCellIds.size > 0;\n\n    for (let i = 0; i < 9; i++) {\n        if (!newBoard.rowSandwich[i].isValid()) {\n            hasError = true;\n            newBoard.rowSandwich[i].error = true;\n        } else {\n            const want = newBoard.rowSandwich[i].value;\n            const has = newBoard.getRowSandwichSum(i);\n            if (want !== null && has !== null && want !== has) {\n                hasError = true;\n                newBoard.rowSandwich[i].error = true;\n            }\n        }\n\n        if (!newBoard.colSandwich[i].isValid()) {\n            hasError = true;\n            newBoard.colSandwich[i].error = true;\n        } else {\n            const want = newBoard.colSandwich[i].value;\n            const has = newBoard.getColSandwichSum(i);\n            if (want !== null && has !== null && want !== has) {\n                hasError = true;\n                newBoard.colSandwich[i].error = true;\n            }\n        }\n    }\n\n    alert(hasError ? 'Error found :(' : 'Looks good to me!');\n    return updateBoard(newBoard);\n}\n\nexport const solve = (board: BoardModel, control: ControlModel): ActionTypes => {\n    let [newBoard, cntSolutions] = solveBoard(board, control);\n    if (cntSolutions >= 2) {\n        alert('Found at least ' + cntSolutions + ' solutions.');\n    } else {\n        alert('Found ' + cntSolutions + ' solution.');\n    }\n    if (newBoard !== null) {\n        return updateBoard(newBoard);\n    }\n    return NO_OP;\n}\n\nexport const generateUrl = (board: BoardModel, control: ControlModel): ActionTypes => {\n    const gameState: any = {\n        values: board.cells.map(cell => {\n            if (cell.value) return cell.value;\n            else return '0';\n        }).join(''),\n        gameOptions: control.gameOptions,\n    };\n    if (control.gameOptions.sandwich) {\n        gameState.rowSandwichSums = board.rowSandwich.map(cell => cell.value);\n        gameState.colSandwichSums = board.colSandwich.map(cell => cell.value);\n    }\n    return {\n        type: ACTION_GENERATE_URL,\n        payload: {\n            url: window.location.origin + window.location.pathname + '#/' + window.btoa(JSON.stringify(gameState)),\n        },\n    };\n};\n","import React from 'react';\nimport { QuestionSquare } from 'react-bootstrap-icons';\nimport Form from 'react-bootstrap/Form';\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\nimport Tooltip from 'react-bootstrap/Tooltip';\nimport { connect, ConnectedProps } from 'react-redux';\nimport { updateGameOptions } from '../../actions/control';\nimport { GameState } from '../Game';\n\n\nclass GameOptions extends React.Component<GameOptionsProps> {\n    renderLabel(label: any, id: string, message: string) {\n        return (\n            <OverlayTrigger\n                placement=\"right\"\n                overlay={<Tooltip id={id}>{message}</Tooltip>}\n            >\n                <span>\n                    {label}&nbsp;\n                    <QuestionSquare />\n                </span>\n            </OverlayTrigger>\n        );\n    }\n\n    render() {\n        return (\n            <div id=\"game-play\">\n                <h4>Game Play</h4>\n                <Form.Check\n                    type='checkbox'\n                    id='checkbox-anti-knight'\n                    label={this.renderLabel('Anti Knight', 'tooltip-anti-knight', \"Two cells which are knight's move away from each other cannot contain the same digit.\")}\n                    checked={this.props.antiKnight}\n                    onChange={() => this.props.updateGameOptions({\n                        ...this.props,\n                        antiKnight: !this.props.antiKnight\n                    })}\n                />\n                <Form.Check\n                    type='checkbox'\n                    id='checkbox-anti-king'\n                    label={this.renderLabel('Anti King', 'tooltip-anti-king', \"Two cells which are king's move away from each other cannot contain the same digit.\")}\n                    checked={this.props.antiKing}\n                    onChange={() => this.props.updateGameOptions({\n                        ...this.props,\n                        antiKing: !this.props.antiKing\n                    })}\n                />\n                <Form.Check\n                    type='checkbox'\n                    id='checkbox-sandwich'\n                    label={this.renderLabel('Sandwich', 'tooltip-sandwich', 'The numbers in each row / column specify the sum between the number 1 and 9 in that row / column.')}\n                    checked={this.props.sandwich}\n                    onChange={() => this.props.updateGameOptions({\n                        ...this.props,\n                        sandwich: !this.props.sandwich\n                    })}\n                />\n            </div>\n        );\n    }\n}\n\nconst mapStateToProps = (state: GameState) => {\n    return {...state.control.gameOptions};\n};\n\nconst connector = connect(mapStateToProps, { updateGameOptions });\n\ntype GameOptionsProps = ConnectedProps<typeof connector>;\n\nexport default connector(GameOptions);\n","import React from 'react';\nimport Button from 'react-bootstrap/Button';\nimport Form from 'react-bootstrap/Form';\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\nimport Tooltip from 'react-bootstrap/Tooltip';\nimport { connect, ConnectedProps } from 'react-redux';\nimport {\n    fillCenter,\n    generateUrl,\n    solve,\n    verify\n    } from '../../actions/control';\nimport { redo, undo } from '../../actions/history';\nimport { GameState } from '../Game';\nimport DisplayOptions from './DisplayOptions';\nimport GameOptions from './GameOptions';\n\n\nclass Control extends React.Component<ControlProps> {\n    renderUrl() {\n        if (!this.props.url) {\n            return;\n        }\n        return <a href={this.props.url}>Link</a>;\n    }\n\n    renderTooltip(id: string, message: string) {\n        return (\n            <Tooltip id={id}>\n                {message}\n            </Tooltip>\n        );\n    }\n\n    render() {\n        return (\n            <Form>\n                <div className=\"\">\n                    <Button onClick={() => this.props.verify(this.props.board, this.props.control)}>\n                        Verify\n                    </Button>\n                    &nbsp;\n                    <Button\n                        onClick={() => this.props.undo(this.props.history)}\n                        className=\"btn-secondary\"\n                    >\n                        Undo\n                    </Button>\n                    &nbsp;\n                    <Button\n                        onClick={() => this.props.redo(this.props.history)}\n                        className=\"btn-secondary\"\n                    >\n                        Redo\n                    </Button>\n                </div>\n                <hr/>\n                <DisplayOptions />\n                <hr/>\n                <GameOptions />\n                <hr/>\n                <h4>Help</h4>\n                <OverlayTrigger\n                    placement=\"top\"\n                    overlay={this.renderTooltip('tooltip-fill-center', 'Show all possible values for each cell.')}\n                >\n                    <Button\n                        onClick={() => this.props.fillCenter(this.props.board, this.props.control)}\n                        className=\"btn-secondary\"\n                    >\n                        Fill all center values\n                    </Button>\n                </OverlayTrigger>\n                &nbsp;\n                <Button\n                    onClick={() => this.props.solve(this.props.board, this.props.control)}\n                    className=\"btn-secondary\"\n                >\n                    Solve\n                </Button>\n                <hr/>\n                <Button\n                    onClick={() => this.props.generateUrl(this.props.board, this.props.control)}\n                    className=\"btn-secondary\"\n                >\n                    Get URL\n                </Button>\n                &nbsp;\n                {this.renderUrl()}\n            </Form>\n        );\n    }\n}\n\nconst mapStateToProps = (state: GameState) => {\n    return {\n        url: state.gameUrl,\n        history: state.history,\n        board: state.board,\n        control: state.control,\n    };\n};\nconst connector = connect(mapStateToProps, {\n    // History actions\n    undo,\n    redo,\n\n    // Control actions.\n    fillCenter,\n    generateUrl,\n    solve,\n    verify,\n});\ntype ControlProps = ConnectedProps<typeof connector>;\n\nexport default connector(Control);\n","import React from 'react';\nimport Button from 'react-bootstrap/Button';\nimport { connect, ConnectedProps } from 'react-redux';\nimport { clearAllColors, color } from '../actions/board';\nimport { GameState } from './Game';\n\n\nclass Palette extends React.Component<PaletteProps> {\n    renderColor(id: number) {\n        let classes = [\"palette-cell\", `color-${id}`];\n        return (\n            <div\n                className={classes.join(' ')}\n                key={`palette-${id}`}\n                onClick={() => this.props.color(this.props.board, id === 0 ? null : id)}\n            >\n            </div>\n        );\n    }\n    render() {\n        const colors = [...Array(5).keys()].map(x => this.renderColor(x));\n        return (\n            <div className=\"row palette\">\n                {colors}\n                <Button\n                    className=\"btn-secondary\"\n                    onClick={() => this.props.clearAllColors(this.props.board)}\n                >\n                    Reset colors\n                </Button>\n            </div>\n        );\n    }\n}\n\nconst mapStateToProps = (state: GameState) => {\n    return {\n        board: state.board,\n    };\n};\n\nconst connector = connect(mapStateToProps, {\n    clearAllColors,\n    color,\n});\n\ntype PaletteProps = ConnectedProps<typeof connector>;\n\nexport default connector(Palette);\n","import React from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\nimport { RouteComponentProps } from 'react-router-dom';\nimport {\n    initGameState,\n    keyDown,\n    mouseDown,\n    mouseOver,\n    mouseUp,\n    select,\n    selectSandwich\n    } from '../actions/board';\nimport { BoardModel } from '../models/board';\nimport { ControlModel } from '../models/control';\nimport { HistoryModel } from '../models/history';\nimport Board from './board/Board';\nimport Control from './control/Control';\nimport Palette from './Palette';\n\n\nexport type GameState = {\n    board: BoardModel,\n    control: ControlModel,\n    history: HistoryModel,\n    gameUrl: string,\n};\n\nclass Game extends React.Component<GameProps, GameState> {\n    componentDidMount() {\n        if (this.props.encoded) {\n            this.props.initGameState(JSON.parse(window.atob(this.props.encoded)));\n        }\n    }\n\n    render() {\n        return (\n            <div\n                onKeyDown={(e) => this.props.keyDown(this.props.board, this.props.control, this.props.history, e)}\n                tabIndex={0}\n                className=\"container\"\n                onMouseUp={() => this.props.mouseUp(this.props.board)}\n                onTouchEnd={() => this.props.mouseUp(this.props.board)}\n            >\n                <h1><a href=\"/sudoku\">Sudoku Tool</a></h1>\n                <div className=\"row\">\n                    <div className=\"col-sm\">\n                        <Board\n                            board={this.props.board}\n                            gameOptions={this.props.control.gameOptions}\n                            onClick={(e, id) => this.props.select(this.props.board, this.props.control, id, !e.metaKey)}\n                            onSelectSandwich={(e, isRow, id) => this.props.selectSandwich(this.props.board, this.props.control, isRow, id)}\n                            onMouseDown={(e, id) => this.props.mouseDown(this.props.board, this.props.control, id, !e.metaKey)}\n                            onMouseOver={(id) => this.props.mouseOver(this.props.board, this.props.control, id)}\n                        />\n                        <Palette />\n                    </div>\n                    <div className=\"col-sm control\">\n                        <Control />\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\ntype OwnProps = RouteComponentProps<{encoded: string}>;\nconst mapStateToProps = (state: GameState, ownProps: OwnProps) => {\n    return {\n        ...state,\n        encoded: ownProps.match.params.encoded,\n    };\n};\n\nconst connector = connect(mapStateToProps, {\n    // board actions.\n    initGameState,\n    keyDown,\n    mouseDown,\n    mouseOver,\n    mouseUp,\n    select,\n    selectSandwich,\n});\n\ntype GameProps = ConnectedProps<typeof connector>;\n\nexport default connector(Game);\n","export type GameOptions = {\n    antiKnight: boolean;\n    antiKing: boolean;\n    sandwich: boolean;\n};\n\nexport type DisplayOptions = {\n    highlightRestricted: boolean;\n    highlightMatchingNumbers: boolean;\n    autoCleanUp: boolean;\n    sandwichHint: boolean;\n};\n\nexport class ControlModel {\n    displayOptions: DisplayOptions;\n    gameOptions: GameOptions;\n\n    constructor() {\n        this.displayOptions = {\n            highlightRestricted: true,\n            highlightMatchingNumbers: false,\n            autoCleanUp: false,\n            sandwichHint: false,\n        };\n        this.gameOptions = {\n            antiKnight: false,\n            antiKing: false,\n            sandwich: false,\n        };\n    }\n}\n","import { BoardModel } from './board';\n\nexport class HistoryModel {\n    boards: Array<string>;\n    id: number;\n\n    constructor() {\n        this.boards = [];\n        this.id = 0;\n\n        const board = new BoardModel();\n        this.boards.push(board.serialize());\n    }\n}\n","import { combineReducers } from 'redux';\nimport { boardReducer } from './board';\nimport { controlReducer } from './control';\nimport { gameUrlReducer } from './gameUrl';\nimport { historyReducer } from './history';\n\n\nconst isMouseDownReducer = (isMouseDown = false) => {\n    return isMouseDown;\n}\n\nconst highlightMatchingReducer = (highlightMatching = null) => {\n    return highlightMatching;\n}\n\nexport default combineReducers({\n    board: boardReducer,\n    control: controlReducer,\n    history: historyReducer,\n    isMouseDown: isMouseDownReducer,\n    highlightMatching: highlightMatchingReducer,\n    gameUrl: gameUrlReducer,\n});\n","import {\n    ACTION_INIT_GAME_STATE,\n    ACTION_REDO,\n    ACTION_UNDO,\n    ACTION_UPDATE_BOARD,\n    ActionTypes\n    } from '../actions/types';\nimport { BoardModel } from '../models/board';\n\nexport const boardReducer = (board = new BoardModel(), action: ActionTypes) => {\n    if (action.type === ACTION_UPDATE_BOARD) {\n        return action.payload.board;\n    }\n    if (action.type === ACTION_UNDO) {\n        const board = new BoardModel();\n        board.load(action.payload.serialized);\n        return board;\n    }\n    if (action.type === ACTION_REDO) {\n        const board = new BoardModel();\n        board.load(action.payload.serialized);\n        return board;\n    }\n    if (action.type === ACTION_INIT_GAME_STATE) {\n        return action.payload.board;\n    }\n\n    return board;\n}\n","import {\n    ACTION_INIT_GAME_STATE,\n    ACTION_UPDATE_DISPLAY,\n    ACTION_UPDATE_GAME_PLAY,\n    ActionTypes\n    } from '../actions/types';\nimport { ControlModel } from '../models/control';\n\nexport const controlReducer = (control: ControlModel = new ControlModel(), action: ActionTypes) => {\n    if (action.type === ACTION_UPDATE_DISPLAY) {\n        return {...control, displayOptions: action.payload};\n    }\n    if (action.type === ACTION_UPDATE_GAME_PLAY) {\n        return {...control, gameOptions: action.payload};\n    }\n    if (action.type === ACTION_INIT_GAME_STATE) {\n        return {...control, gameOptions: action.payload.gameOptions};\n    }\n    return control;\n};\n","import assert from 'assert';\nimport {\n    ACTION_INIT_GAME_STATE,\n    ACTION_REDO,\n    ACTION_UNDO,\n    ACTION_UPDATE_BOARD,\n    ActionTypes\n    } from '../actions/types';\nimport { HistoryModel } from '../models/history';\n\nexport const historyReducer = (history = new HistoryModel(), action: ActionTypes) => {\n    if (action.type === ACTION_INIT_GAME_STATE) {\n        return {\n            boards: [action.payload.board.serialize()],\n            id: 0,\n        };\n    }\n    if (action.type === ACTION_UPDATE_BOARD) {\n        const serialized = action.payload.board.serialize();\n\n        // Only update history if the serialized new board is different.\n        // Thus, we ignore all selections and restrictions.\n        if (serialized !== history.boards[history.id]) {\n            // Remove the rest of history.\n            // This clean data in case we do lots of undo, and then make a new move.\n            history.boards = history.boards.slice(0, history.id + 1);\n\n            // Update history.\n            history.boards.push(serialized);\n            history.id += 1;\n        }\n        return history;\n    }\n    if (action.type === ACTION_UNDO) {\n        assert(history.id > 0);\n        return {...history, id: history.id - 1 };\n    }\n    if (action.type === ACTION_REDO) {\n        assert(history.id + 1 < history.boards.length);\n        return {...history, id: history.id + 1 };\n    }\n    return history;\n}\n","import { ACTION_GENERATE_URL, ActionTypes } from '../actions/types';\n\nexport const gameUrlReducer = (gameUrl = null, action: ActionTypes) => {\n    if (action.type === ACTION_GENERATE_URL) {\n        return action.payload.url;\n    }\n    return gameUrl;\n}\n","import 'bootstrap/dist/css/bootstrap.min.css';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport { HashRouter, Route } from 'react-router-dom';\nimport { createStore } from 'redux';\nimport Game from './components/Game';\nimport './index.css';\nimport reducers from './reducers';\n\n\nconst store = createStore(\n    reducers,\n    (window as any).__REDUX_DEVTOOLS_EXTENSION__ && (window as any).__REDUX_DEVTOOLS_EXTENSION__()\n);\n\nReactDOM.render(\n    <Provider store={store}>\n        <HashRouter>\n            <Route path=\"/:encoded?\" component={Game} />\n        </HashRouter>\n    </Provider>,\n    document.getElementById('root')\n);\n"],"sourceRoot":""}